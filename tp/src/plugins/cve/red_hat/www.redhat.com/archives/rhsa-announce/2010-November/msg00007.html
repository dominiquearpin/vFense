<!-- MHonArc v2.6.16 -->
<!--X-Subject: [RHSA&#45;2010:0838&#45;01] Moderate: pki security and enhancement update -->
<!--X-From-R13: ohtmvyynNerqung.pbz -->
<!--X-Date: Mon, 8 Nov 2010 15:28:00 &#45;0500 -->
<!--X-Message-Id: 201011082027.oA8KRsTH008286@int&#45;mx09.intmail.prod.int.phx2.redhat.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!--#include virtual="/header.html"-->
<!--#include virtual="/search.html"-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>[RHSA-2010:0838-01] Moderate: pki security and enhancement update</TITLE>
<LINK REV="made" HREF="mailto:bugzilla redhat com">
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<a href="msg00006.html">Date Prev</a>][<a href="msg00008.html">Date Next</a>] &nbsp; [<a href="msg00006.html">Thread Prev</a>][<a href="msg00008.html">Thread Next</a>] &nbsp; 
[<A HREF="thread.html#00007">Thread Index</A>]
[<A HREF="date.html#00007">Date Index</A>]
[<A HREF="author.html#00007">Author Index</A>]

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[RHSA-2010:0838-01] Moderate: pki security and enhancement update</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>From</em>: bugzilla redhat com</li>
<li><em>To</em>: rhsa-announce redhat com</li>
<li><em>Cc</em>: </li>
<li><em>Subject</em>: [RHSA-2010:0838-01] Moderate: pki security and enhancement update</li>
<li><em>Date</em>: Mon, 8 Nov 2010 13:27:54 -0700</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

=====================================================================
                   Red Hat Security Advisory

Synopsis:          Moderate: pki security and enhancement update
Advisory ID:       RHSA-2010:0838-01
Product:           Red Hat Certificate System
Advisory URL:      <a  rel="nofollow" href="https://rhn.redhat.com/errata/RHSA-2010-0838.html">https://rhn.redhat.com/errata/RHSA-2010-0838.html</a>
Issue date:        2010-11-08
CVE Names:         CVE-2004-2761 CVE-2010-3868 CVE-2010-3869 
=====================================================================

1. Summary:

Updated pki-ca, pki-util, and pki-common packages that fix three security
issues and add several enhancements are now available for Red Hat
Certificate System 8.

The Red Hat Security Response Team has rated this update as having moderate
security impact. Common Vulnerability Scoring System (CVSS) base scores,
which give detailed severity ratings, are available for each vulnerability
from the CVE links in the References section.

2. Relevant releases/architectures:

Red Hat Certificate System 8 - noarch

3. Description:

Red Hat Certificate System is an enterprise software system designed to
manage enterprise public key infrastructure (PKI) deployments. Simple
Certificate Enrollment Protocol (SCEP) is a PKI communication protocol
used to automatically enroll certificates for network devices.

The certificate authority allowed unauthenticated users to request the
one-time PIN in an SCEP request to be decrypted. An attacker able to sniff
an SCEP request from a network device could request the certificate
authority to decrypt the request, allowing them to obtain the one-time
PIN. With this update, the certificate authority only handles decryption
requests from authenticated registration authorities. (CVE-2010-3868)

The certificate authority allowed the one-time PIN used in SCEP requests
to be re-used. An attacker possessing a valid SCEP enrollment one-time PIN
could use it to generate an unlimited number of certificates.
(CVE-2010-3869)

The certificate authority used the MD5 hash algorithm to sign all SCEP
protocol responses. As MD5 is not collision resistant, an attacker could
use this flaw to perform an MD5 chosen-prefix collision attack to generate
attack-chosen output signed using the certificate authority's key.
(CVE-2004-2761)

This update also adds the following enhancements:

* New configuration options for the SCEP server can define the default and
allowed encryption and hash algorithms. These options allow disabling uses
of the weaker algorithms not required by network devices and prevent
possible downgrade attacks. These can be configured by adding the following
options to the certificate authority's CS.cfg configuration file:

   ca.scep.encryptionAlgorithm=DES3
   ca.scep.allowedEncryptionAlgorithms=DES3
   ca.scep.hashAlgorithm=SHA1
   ca.scep.allowedHashAlgorithms=SHA1,SHA256,SHA512

* With this update, the certificate authority's SCEP server is disabled by
default. The SCEP server can be enabled by adding the 'ca.scep.enable=true'
option to the certificate authority's CS.cfg configuration file.

* A separate key pair can now be configured for use in SCEP communication.
Previously, the main certificate authority's key pair was used for SCEP
communication too. A designated SCEP key pair can be referenced by adding
a new option, ca.scep.nickname=[scep certificate nickname], to the
certificate authority's CS.cfg configuration file.

* The certificate authority now allows the size of nonces used in SCEP
requests to be restricted by adding a new option, ca.scep.nonceSizeLimit=
[number of bytes], to the certificate authority's CS.cfg configuration
file. The limit is set to 16 bytes in the default CS.cfg configuration
file.

All users of Red Hat Certificate System 8 should upgrade to these updated
packages, which resolve these issues and add these enhancements.

4. Solution:

Before applying this update, make sure all previously-released errata
relevant to your system have been applied.

This update is available via the Red Hat Network. Details on how to
use the Red Hat Network to apply this update are available at
<a  rel="nofollow" href="http://kbase.redhat.com/faq/docs/DOC-11259">http://kbase.redhat.com/faq/docs/DOC-11259</a>

5. Bugs fixed (<a  rel="nofollow" href="http://bugzilla.redhat.com/">http://bugzilla.redhat.com/</a>):

648882 - CVE-2010-3868 Certificate System: unauthenticated user can request SCEP one-time PIN decryption
648883 - CVE-2010-3869 Certificate System: SCEP one-time PIN reuse
648886 - CVE-2004-2761 MD5: MD5 Message-Digest Algorithm is not collision resistant

6. Package List:

Red Hat Certificate System 8:

Source:
pki-ca-8.0.7-1.el5pki.src.rpm
pki-common-8.0.6-2.el5pki.src.rpm
pki-util-8.0.5-1.el5pki.src.rpm

noarch:
pki-ca-8.0.7-1.el5pki.noarch.rpm
pki-common-8.0.6-2.el5pki.noarch.rpm
pki-common-javadoc-8.0.6-2.el5pki.noarch.rpm
pki-util-8.0.5-1.el5pki.noarch.rpm
pki-util-javadoc-8.0.5-1.el5pki.noarch.rpm

These packages are GPG signed by Red Hat for security.  Our key and 
details on how to verify the signature are available from
<a  rel="nofollow" href="https://www.redhat.com/security/team/key/#package">https://www.redhat.com/security/team/key/#package</a>

7. References:

<a  rel="nofollow" href="https://www.redhat.com/security/data/cve/CVE-2004-2761.html">https://www.redhat.com/security/data/cve/CVE-2004-2761.html</a>
<a  rel="nofollow" href="https://www.redhat.com/security/data/cve/CVE-2010-3868.html">https://www.redhat.com/security/data/cve/CVE-2010-3868.html</a>
<a  rel="nofollow" href="https://www.redhat.com/security/data/cve/CVE-2010-3869.html">https://www.redhat.com/security/data/cve/CVE-2010-3869.html</a>
<a  rel="nofollow" href="http://www.redhat.com/security/updates/classification/#moderate">http://www.redhat.com/security/updates/classification/#moderate</a>

8. Contact:

The Red Hat security contact is &lt;secalert redhat com&gt;.  More contact
details at <a  rel="nofollow" href="https://www.redhat.com/security/team/contact/">https://www.redhat.com/security/team/contact/</a>

Copyright 2010 Red Hat, Inc.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.4 (GNU/Linux)

iD8DBQFM2F03XlSAg2UNWIIRAgXXAKDEyATxbggfyGsg8a2z8R4Ic1ZiMQCfbBbt
YlLAX1lKZpWDyltWoNw4Bi0=
=DZVc
-----END PGP SIGNATURE-----


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
[<a href="msg00006.html">Date Prev</a>][<a href="msg00008.html">Date Next</a>] &nbsp; [<a href="msg00006.html">Thread Prev</a>][<a href="msg00008.html">Thread Next</a>] &nbsp; 
[<A HREF="thread.html#00007">Thread Index</A>]
[<A HREF="date.html#00007">Date Index</A>]
[<A HREF="author.html#00007">Author Index</A>]

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!--#include virtual="/footer.html"-->
</body>
</html>

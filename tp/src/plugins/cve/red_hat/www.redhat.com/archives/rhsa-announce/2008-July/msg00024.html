<!-- MHonArc v2.6.12 -->
<!--X-Subject: [RHSA&#45;2008:0582&#45;01] Moderate: php security update -->
<!--X-From-R13: ohtmvyynNerqung.pbz -->
<!--X-Date: Tue, 22 Jul 2008 08:31:59 &#45;0400 -->
<!--X-Message-Id: 200807221231.m6MCVv8V022477@pobox.devel.redhat.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!--#include virtual="/header.html"-->
<!--#include virtual="/search.html"-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>[RHSA-2008:0582-01] Moderate: php security update</TITLE>
<LINK REV="made" HREF="mailto:bugzilla@redhat.com">
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<a href="msg00023.html">Date Prev</a>][<a href="msg00025.html">Date Next</a>] &nbsp; [<a href="msg00023.html">Thread Prev</a>][<a href="msg00025.html">Thread Next</a>] &nbsp; 
[<A HREF="thread.html#00024">Thread Index</A>]
[<A HREF="date.html#00024">Date Index</A>]
[<A HREF="author.html#00024">Author Index</A>]

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[RHSA-2008:0582-01] Moderate: php security update</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>From</em>: bugzilla redhat com</li>
<li><em>To</em>: rhsa-announce redhat com, enterprise-watch-list redhat com</li>
<li><em>Cc</em>: </li>
<li><em>Subject</em>: [RHSA-2008:0582-01] Moderate: php security update</li>
<li><em>Date</em>: Tue, 22 Jul 2008 08:31:57 -0400</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

=====================================================================
                   Red Hat Security Advisory

Synopsis:          Moderate: php security update
Advisory ID:       RHSA-2008:0582-01
Product:           Red Hat Application Stack
Advisory URL:      <a  rel="nofollow" href="https://rhn.redhat.com/errata/RHSA-2008-0582.html">https://rhn.redhat.com/errata/RHSA-2008-0582.html</a>
Issue date:        2008-07-22
CVE Names:         CVE-2008-2051 CVE-2007-5898 CVE-2007-5899 
                   CVE-2007-4782 CVE-2008-2107 CVE-2008-2108 
=====================================================================

1. Summary:

Updated PHP packages that fix several security issues are now available for
Red Hat Application Stack v1.

This update has been rated as having moderate security impact by the Red
Hat Security Response Team.

2. Relevant releases/architectures:

Red Hat Application Stack v1 for Enterprise Linux AS (v.4) - i386, x86_64
Red Hat Application Stack v1 for Enterprise Linux ES (v.4) - i386, x86_64

3. Description:

PHP is an HTML-embedded scripting language commonly used with the Apache
HTTP Web server.

It was discovered that the PHP escapeshellcmd() function did not properly
escape multi-byte characters which are not valid in the locale used by the
script. This could allow an attacker to bypass quoting restrictions imposed
by escapeshellcmd() and execute arbitrary commands if the PHP script was
using certain locales. Scripts using the default UTF-8 locale are not
affected by this issue. (CVE-2008-2051)

PHP functions htmlentities() and htmlspecialchars() did not properly
recognize partial multi-byte sequences. Certain sequences of bytes could be
passed through these functions without being correctly HTML-escaped.
Depending on the browser being used, an attacker could use this flaw to
conduct cross-site scripting attacks. (CVE-2007-5898)

A PHP script which used the transparent session ID configuration option, or
which used the output_add_rewrite_var() function, could leak session
identifiers to external web sites. If a page included an HTML form with an
ACTION attribute referencing a non-local URL, the user's session ID would
be included in the form data passed to that URL. (CVE-2007-5899)

It was discovered that PHP fnmatch() function did not restrict the length
of the string argument. An attacker could use this flaw to crash the PHP
interpreter where a script used fnmatch() on untrusted input data.
(CVE-2007-4782)

It was discovered that PHP did not properly seed its pseudo-random number
generator used by functions such as rand() and mt_rand(), possibly allowing
an attacker to easily predict the generated pseudo-random values.
(CVE-2008-2107, CVE-2008-2108)

Users of PHP should upgrade to these updated packages, which contain
backported patches to correct these issues.

4. Solution:

Before applying this update, make sure that all previously-released
errata relevant to your system have been applied.  

This update is available via Red Hat Network.  Details on how to use 
the Red Hat Network to apply this update are available at
<a  rel="nofollow" href="http://kbase.redhat.com/faq/FAQ_58_10188">http://kbase.redhat.com/faq/FAQ_58_10188</a>

5. Bugs fixed (<a  rel="nofollow" href="http://bugzilla.redhat.com/">http://bugzilla.redhat.com/</a>):

285881 - CVE-2007-4782 php crash in glob() and fnmatch() functions
382411 - CVE-2007-5898 php htmlentities/htmlspecialchars multibyte sequences
382431 - CVE-2007-5899 php session ID leakage
445006 - CVE-2008-2051 PHP multibyte shell escape flaw
445684 - CVE-2008-2107 PHP 32 bit weak random seed
445685 - CVE-2008-2108 PHP weak 64 bit random seed

6. Package List:

Red Hat Application Stack v1 for Enterprise Linux AS (v.4):

Source:
<a  rel="nofollow" href="ftp://updates.redhat.com/enterprise/4AS/en/RHWAS/SRPMS/php-5.1.6-3.el4s1.10.src.rpm">ftp://updates.redhat.com/enterprise/4AS/en/RHWAS/SRPMS/php-5.1.6-3.el4s1.10.src.rpm</a>

i386:
php-5.1.6-3.el4s1.10.i386.rpm
php-bcmath-5.1.6-3.el4s1.10.i386.rpm
php-cli-5.1.6-3.el4s1.10.i386.rpm
php-common-5.1.6-3.el4s1.10.i386.rpm
php-dba-5.1.6-3.el4s1.10.i386.rpm
php-debuginfo-5.1.6-3.el4s1.10.i386.rpm
php-devel-5.1.6-3.el4s1.10.i386.rpm
php-gd-5.1.6-3.el4s1.10.i386.rpm
php-imap-5.1.6-3.el4s1.10.i386.rpm
php-ldap-5.1.6-3.el4s1.10.i386.rpm
php-mbstring-5.1.6-3.el4s1.10.i386.rpm
php-mysql-5.1.6-3.el4s1.10.i386.rpm
php-ncurses-5.1.6-3.el4s1.10.i386.rpm
php-odbc-5.1.6-3.el4s1.10.i386.rpm
php-pdo-5.1.6-3.el4s1.10.i386.rpm
php-pgsql-5.1.6-3.el4s1.10.i386.rpm
php-snmp-5.1.6-3.el4s1.10.i386.rpm
php-soap-5.1.6-3.el4s1.10.i386.rpm
php-xml-5.1.6-3.el4s1.10.i386.rpm
php-xmlrpc-5.1.6-3.el4s1.10.i386.rpm

x86_64:
php-5.1.6-3.el4s1.10.x86_64.rpm
php-bcmath-5.1.6-3.el4s1.10.x86_64.rpm
php-cli-5.1.6-3.el4s1.10.x86_64.rpm
php-common-5.1.6-3.el4s1.10.x86_64.rpm
php-dba-5.1.6-3.el4s1.10.x86_64.rpm
php-debuginfo-5.1.6-3.el4s1.10.x86_64.rpm
php-devel-5.1.6-3.el4s1.10.x86_64.rpm
php-gd-5.1.6-3.el4s1.10.x86_64.rpm
php-imap-5.1.6-3.el4s1.10.x86_64.rpm
php-ldap-5.1.6-3.el4s1.10.x86_64.rpm
php-mbstring-5.1.6-3.el4s1.10.x86_64.rpm
php-mysql-5.1.6-3.el4s1.10.x86_64.rpm
php-ncurses-5.1.6-3.el4s1.10.x86_64.rpm
php-odbc-5.1.6-3.el4s1.10.x86_64.rpm
php-pdo-5.1.6-3.el4s1.10.x86_64.rpm
php-pgsql-5.1.6-3.el4s1.10.x86_64.rpm
php-snmp-5.1.6-3.el4s1.10.x86_64.rpm
php-soap-5.1.6-3.el4s1.10.x86_64.rpm
php-xml-5.1.6-3.el4s1.10.x86_64.rpm
php-xmlrpc-5.1.6-3.el4s1.10.x86_64.rpm

Red Hat Application Stack v1 for Enterprise Linux ES (v.4):

Source:
<a  rel="nofollow" href="ftp://updates.redhat.com/enterprise/4ES/en/RHWAS/SRPMS/php-5.1.6-3.el4s1.10.src.rpm">ftp://updates.redhat.com/enterprise/4ES/en/RHWAS/SRPMS/php-5.1.6-3.el4s1.10.src.rpm</a>

i386:
php-5.1.6-3.el4s1.10.i386.rpm
php-bcmath-5.1.6-3.el4s1.10.i386.rpm
php-cli-5.1.6-3.el4s1.10.i386.rpm
php-common-5.1.6-3.el4s1.10.i386.rpm
php-dba-5.1.6-3.el4s1.10.i386.rpm
php-debuginfo-5.1.6-3.el4s1.10.i386.rpm
php-devel-5.1.6-3.el4s1.10.i386.rpm
php-gd-5.1.6-3.el4s1.10.i386.rpm
php-imap-5.1.6-3.el4s1.10.i386.rpm
php-ldap-5.1.6-3.el4s1.10.i386.rpm
php-mbstring-5.1.6-3.el4s1.10.i386.rpm
php-mysql-5.1.6-3.el4s1.10.i386.rpm
php-ncurses-5.1.6-3.el4s1.10.i386.rpm
php-odbc-5.1.6-3.el4s1.10.i386.rpm
php-pdo-5.1.6-3.el4s1.10.i386.rpm
php-pgsql-5.1.6-3.el4s1.10.i386.rpm
php-snmp-5.1.6-3.el4s1.10.i386.rpm
php-soap-5.1.6-3.el4s1.10.i386.rpm
php-xml-5.1.6-3.el4s1.10.i386.rpm
php-xmlrpc-5.1.6-3.el4s1.10.i386.rpm

x86_64:
php-5.1.6-3.el4s1.10.x86_64.rpm
php-bcmath-5.1.6-3.el4s1.10.x86_64.rpm
php-cli-5.1.6-3.el4s1.10.x86_64.rpm
php-common-5.1.6-3.el4s1.10.x86_64.rpm
php-dba-5.1.6-3.el4s1.10.x86_64.rpm
php-debuginfo-5.1.6-3.el4s1.10.x86_64.rpm
php-devel-5.1.6-3.el4s1.10.x86_64.rpm
php-gd-5.1.6-3.el4s1.10.x86_64.rpm
php-imap-5.1.6-3.el4s1.10.x86_64.rpm
php-ldap-5.1.6-3.el4s1.10.x86_64.rpm
php-mbstring-5.1.6-3.el4s1.10.x86_64.rpm
php-mysql-5.1.6-3.el4s1.10.x86_64.rpm
php-ncurses-5.1.6-3.el4s1.10.x86_64.rpm
php-odbc-5.1.6-3.el4s1.10.x86_64.rpm
php-pdo-5.1.6-3.el4s1.10.x86_64.rpm
php-pgsql-5.1.6-3.el4s1.10.x86_64.rpm
php-snmp-5.1.6-3.el4s1.10.x86_64.rpm
php-soap-5.1.6-3.el4s1.10.x86_64.rpm
php-xml-5.1.6-3.el4s1.10.x86_64.rpm
php-xmlrpc-5.1.6-3.el4s1.10.x86_64.rpm

These packages are GPG signed by Red Hat for security.  Our key and 
details on how to verify the signature are available from
<a  rel="nofollow" href="https://www.redhat.com/security/team/key/#package">https://www.redhat.com/security/team/key/#package</a>

7. References:

<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2051">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2051</a>
<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5898">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5898</a>
<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5899">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5899</a>
<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-4782">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-4782</a>
<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2107">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2107</a>
<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2108">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2108</a>
<a  rel="nofollow" href="http://www.redhat.com/security/updates/classification/#moderate">http://www.redhat.com/security/updates/classification/#moderate</a>

8. Contact:

The Red Hat security contact is &lt;secalert redhat com&gt;.  More contact
details at <a  rel="nofollow" href="https://www.redhat.com/security/team/contact/">https://www.redhat.com/security/team/contact/</a>

Copyright 2008 Red Hat, Inc.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.4 (GNU/Linux)

iD8DBQFIhdMrXlSAg2UNWIIRAv6eAKCb/Uo5NdU/wGCV7t1uxOgPzWZVMgCfXQZC
qV8KMB7Oc0svuN3gB/rcFQw=
=htz1
-----END PGP SIGNATURE-----


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
[<a href="msg00023.html">Date Prev</a>][<a href="msg00025.html">Date Next</a>] &nbsp; [<a href="msg00023.html">Thread Prev</a>][<a href="msg00025.html">Thread Next</a>] &nbsp; 
[<A HREF="thread.html#00024">Thread Index</A>]
[<A HREF="date.html#00024">Date Index</A>]
[<A HREF="author.html#00024">Author Index</A>]

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!--#include virtual="/footer.html"-->
</body>
</html>

<!-- MHonArc v2.6.12 -->
<!--X-Subject: [RHSA&#45;2008:0546&#45;01] Moderate: php security update -->
<!--X-From-R13: ohtmvyynNerqung.pbz -->
<!--X-Date: Wed, 16 Jul 2008 05:59:34 &#45;0400 -->
<!--X-Message-Id: 200807160959.m6G9xXAD029983@pobox.devel.redhat.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!--#include virtual="/header.html"-->
<!--#include virtual="/search.html"-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>[RHSA-2008:0546-01] Moderate: php security update</TITLE>
<LINK REV="made" HREF="mailto:bugzilla@redhat.com">
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<a href="msg00017.html">Date Prev</a>][<a href="msg00019.html">Date Next</a>] &nbsp; [<a href="msg00017.html">Thread Prev</a>][<a href="msg00019.html">Thread Next</a>] &nbsp; 
[<A HREF="thread.html#00018">Thread Index</A>]
[<A HREF="date.html#00018">Date Index</A>]
[<A HREF="author.html#00018">Author Index</A>]

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[RHSA-2008:0546-01] Moderate: php security update</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>From</em>: bugzilla redhat com</li>
<li><em>To</em>: rhsa-announce redhat com, enterprise-watch-list redhat com</li>
<li><em>Cc</em>: </li>
<li><em>Subject</em>: [RHSA-2008:0546-01] Moderate: php security update</li>
<li><em>Date</em>: Wed, 16 Jul 2008 05:59:33 -0400</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

=====================================================================
                   Red Hat Security Advisory

Synopsis:          Moderate: php security update
Advisory ID:       RHSA-2008:0546-01
Product:           Red Hat Enterprise Linux
Advisory URL:      <a  rel="nofollow" href="https://rhn.redhat.com/errata/RHSA-2008-0546.html">https://rhn.redhat.com/errata/RHSA-2008-0546.html</a>
Issue date:        2008-07-16
CVE Names:         CVE-2008-2051 CVE-2007-5898 CVE-2007-5899 
                   CVE-2006-7228 CVE-2007-1660 CVE-2008-2107 
                   CVE-2008-2108 
=====================================================================

1. Summary:

Updated PHP packages that fix several security issues are now available for
Red Hat Enterprise Linux 2.1.

This update has been rated as having moderate security impact by the Red
Hat Security Response Team.

2. Relevant releases/architectures:

Red Hat Enterprise Linux AS (Advanced Server) version 2.1  - i386, ia64
Red Hat Linux Advanced Workstation 2.1 - ia64
Red Hat Enterprise Linux ES version 2.1 - i386
Red Hat Enterprise Linux WS version 2.1 - i386

3. Description:

PHP is an HTML-embedded scripting language commonly used with the Apache
HTTP Web server.

It was discovered that the PHP escapeshellcmd() function did not properly
escape multi-byte characters which are not valid in the locale used by the
script. This could allow an attacker to bypass quoting restrictions imposed
by escapeshellcmd() and execute arbitrary commands if the PHP script was
using certain locales. Scripts using the default UTF-8 locale are not
affected by this issue. (CVE-2008-2051)

The PHP functions htmlentities() and htmlspecialchars() did not properly
recognize partial multi-byte sequences. Certain sequences of bytes could be
passed through these functions without being correctly HTML-escaped.
Depending on the browser being used, an attacker could use this flaw to
conduct cross-site scripting attacks. (CVE-2007-5898)

A PHP script which used the transparent session ID configuration option, or
which used the output_add_rewrite_var() function, could leak session
identifiers to external web sites. If a page included an HTML form with an
ACTION attribute referencing a non-local URL, the user's session ID would
be included in the form data passed to that URL. (CVE-2007-5899)

It was discovered that PHP did not properly seed its pseudo-random number
generator used by functions such as rand() and mt_rand(), possibly allowing
an attacker to easily predict the generated pseudo-random values.
(CVE-2008-2107, CVE-2008-2108)

Integer overflow and memory requirements miscalculation issues were
discovered in the Perl-Compatible Regular Expression (PCRE) library used by
PHP to process regular expressions. These issues could cause a crash, or
possibly execute an arbitrary code with the privileges of the PHP script
that processes regular expressions from untrusted sources. Note: PHP
packages shipped with Red Hat Enterprise Linux 2.1 did not use the
system-level PCRE library. By default they used an embedded copy of the
library included with the PHP package. (CVE-2006-7228, CVE-2007-1660)

Users of PHP should upgrade to these updated packages, which contain
backported patches to correct these issues.

4. Solution:

Before applying this update, make sure that all previously-released
errata relevant to your system have been applied.  

This update is available via Red Hat Network.  Details on how to use 
the Red Hat Network to apply this update are available at
<a  rel="nofollow" href="http://kbase.redhat.com/faq/FAQ_58_10188">http://kbase.redhat.com/faq/FAQ_58_10188</a>

5. Bugs fixed (<a  rel="nofollow" href="http://bugzilla.redhat.com/">http://bugzilla.redhat.com/</a>):

315881 - CVE-2007-1660 pcre regular expression flaws
382411 - CVE-2007-5898 php htmlentities/htmlspecialchars multibyte sequences
382431 - CVE-2007-5899 php session ID leakage
383371 - CVE-2006-7228 pcre integer overflow
445006 - CVE-2008-2051 PHP multibyte shell escape flaw
445684 - CVE-2008-2107 PHP 32 bit weak random seed
445685 - CVE-2008-2108 PHP weak 64 bit random seed

6. Package List:

Red Hat Enterprise Linux AS (Advanced Server) version 2.1 :

Source:
<a  rel="nofollow" href="ftp://updates.redhat.com/enterprise/2.1AS/en/os/SRPMS/php-4.1.2-2.20.src.rpm">ftp://updates.redhat.com/enterprise/2.1AS/en/os/SRPMS/php-4.1.2-2.20.src.rpm</a>

i386:
php-4.1.2-2.20.i386.rpm
php-devel-4.1.2-2.20.i386.rpm
php-imap-4.1.2-2.20.i386.rpm
php-ldap-4.1.2-2.20.i386.rpm
php-manual-4.1.2-2.20.i386.rpm
php-mysql-4.1.2-2.20.i386.rpm
php-odbc-4.1.2-2.20.i386.rpm
php-pgsql-4.1.2-2.20.i386.rpm

ia64:
php-4.1.2-2.20.ia64.rpm
php-devel-4.1.2-2.20.ia64.rpm
php-imap-4.1.2-2.20.ia64.rpm
php-ldap-4.1.2-2.20.ia64.rpm
php-manual-4.1.2-2.20.ia64.rpm
php-mysql-4.1.2-2.20.ia64.rpm
php-odbc-4.1.2-2.20.ia64.rpm
php-pgsql-4.1.2-2.20.ia64.rpm

Red Hat Linux Advanced Workstation 2.1:

Source:
<a  rel="nofollow" href="ftp://updates.redhat.com/enterprise/2.1AW/en/os/SRPMS/php-4.1.2-2.20.src.rpm">ftp://updates.redhat.com/enterprise/2.1AW/en/os/SRPMS/php-4.1.2-2.20.src.rpm</a>

ia64:
php-4.1.2-2.20.ia64.rpm
php-devel-4.1.2-2.20.ia64.rpm
php-imap-4.1.2-2.20.ia64.rpm
php-ldap-4.1.2-2.20.ia64.rpm
php-manual-4.1.2-2.20.ia64.rpm
php-mysql-4.1.2-2.20.ia64.rpm
php-odbc-4.1.2-2.20.ia64.rpm
php-pgsql-4.1.2-2.20.ia64.rpm

Red Hat Enterprise Linux ES version 2.1:

Source:
<a  rel="nofollow" href="ftp://updates.redhat.com/enterprise/2.1ES/en/os/SRPMS/php-4.1.2-2.20.src.rpm">ftp://updates.redhat.com/enterprise/2.1ES/en/os/SRPMS/php-4.1.2-2.20.src.rpm</a>

i386:
php-4.1.2-2.20.i386.rpm
php-devel-4.1.2-2.20.i386.rpm
php-imap-4.1.2-2.20.i386.rpm
php-ldap-4.1.2-2.20.i386.rpm
php-manual-4.1.2-2.20.i386.rpm
php-mysql-4.1.2-2.20.i386.rpm
php-odbc-4.1.2-2.20.i386.rpm
php-pgsql-4.1.2-2.20.i386.rpm

Red Hat Enterprise Linux WS version 2.1:

Source:
<a  rel="nofollow" href="ftp://updates.redhat.com/enterprise/2.1WS/en/os/SRPMS/php-4.1.2-2.20.src.rpm">ftp://updates.redhat.com/enterprise/2.1WS/en/os/SRPMS/php-4.1.2-2.20.src.rpm</a>

i386:
php-4.1.2-2.20.i386.rpm
php-devel-4.1.2-2.20.i386.rpm
php-imap-4.1.2-2.20.i386.rpm
php-ldap-4.1.2-2.20.i386.rpm
php-manual-4.1.2-2.20.i386.rpm
php-mysql-4.1.2-2.20.i386.rpm
php-odbc-4.1.2-2.20.i386.rpm
php-pgsql-4.1.2-2.20.i386.rpm

These packages are GPG signed by Red Hat for security.  Our key and 
details on how to verify the signature are available from
<a  rel="nofollow" href="https://www.redhat.com/security/team/key/#package">https://www.redhat.com/security/team/key/#package</a>

7. References:

<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2051">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2051</a>
<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5898">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5898</a>
<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5899">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5899</a>
<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-7228">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-7228</a>
<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-1660">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-1660</a>
<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2107">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2107</a>
<a  rel="nofollow" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2108">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2108</a>
<a  rel="nofollow" href="http://www.redhat.com/security/updates/classification/#moderate">http://www.redhat.com/security/updates/classification/#moderate</a>

8. Contact:

The Red Hat security contact is &lt;secalert redhat com&gt;.  More contact
details at <a  rel="nofollow" href="https://www.redhat.com/security/team/contact/">https://www.redhat.com/security/team/contact/</a>

Copyright 2008 Red Hat, Inc.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.4 (GNU/Linux)

iD8DBQFIfcZ8XlSAg2UNWIIRApNUAJ4zkxoEST7BV0cROBSgYRsSWL5WIACdHcEX
RglnYO1z72hpkPRvdnwTp8Q=
=bKAh
-----END PGP SIGNATURE-----


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
[<a href="msg00017.html">Date Prev</a>][<a href="msg00019.html">Date Next</a>] &nbsp; [<a href="msg00017.html">Thread Prev</a>][<a href="msg00019.html">Thread Next</a>] &nbsp; 
[<A HREF="thread.html#00018">Thread Index</A>]
[<A HREF="date.html#00018">Date Index</A>]
[<A HREF="author.html#00018">Author Index</A>]

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!--#include virtual="/footer.html"-->
</body>
</html>

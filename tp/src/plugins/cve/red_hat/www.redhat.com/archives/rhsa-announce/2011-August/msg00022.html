<!-- MHonArc v2.6.16 -->
<!--X-Subject: [RHSA&#45;2011:1220&#45;01] Moderate: samba3x security update -->
<!--X-From-R13: ohtmvyynNerqung.pbz -->
<!--X-Date: Mon, 29 Aug 2011 13:48:58 &#45;0400 -->
<!--X-Message-Id: 201108291748.p7THmqjp013782@int&#45;mx02.intmail.prod.int.phx2.redhat.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!--#include virtual="/header.html"-->
<!--#include virtual="/search.html"-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>[RHSA-2011:1220-01] Moderate: samba3x security update</TITLE>
<LINK REV="made" HREF="mailto:bugzilla redhat com">
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<a href="msg00021.html">Date Prev</a>][<a href="msg00023.html">Date Next</a>] &nbsp; [<a href="msg00021.html">Thread Prev</a>][<a href="msg00023.html">Thread Next</a>] &nbsp; 
[<A HREF="thread.html#00022">Thread Index</A>]
[<A HREF="date.html#00022">Date Index</A>]
[<A HREF="author.html#00022">Author Index</A>]

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[RHSA-2011:1220-01] Moderate: samba3x security update</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>From</em>: bugzilla redhat com</li>
<li><em>To</em>: rhsa-announce redhat com, enterprise-watch-list redhat com</li>
<li><em>Subject</em>: [RHSA-2011:1220-01] Moderate: samba3x security update</li>
<li><em>Date</em>: Mon, 29 Aug 2011 17:48:52 +0000</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

=====================================================================
                   Red Hat Security Advisory

Synopsis:          Moderate: samba3x security update
Advisory ID:       RHSA-2011:1220-01
Product:           Red Hat Enterprise Linux
Advisory URL:      <a  rel="nofollow" href="https://rhn.redhat.com/errata/RHSA-2011-1220.html">https://rhn.redhat.com/errata/RHSA-2011-1220.html</a>
Issue date:        2011-08-29
CVE Names:         CVE-2011-1678 CVE-2011-2522 CVE-2011-2694 
                   CVE-2011-2724 
=====================================================================

1. Summary:

Updated samba3x packages that fix multiple security issues are now
available for Red Hat Enterprise Linux 5.

The Red Hat Security Response Team has rated this update as having moderate
security impact. Common Vulnerability Scoring System (CVSS) base scores,
which give detailed severity ratings, are available for each vulnerability
from the CVE links in the References section.

2. Relevant releases/architectures:

RHEL Desktop Workstation (v. 5 client) - i386, x86_64
Red Hat Enterprise Linux (v. 5 server) - i386, ia64, ppc, s390x, x86_64
Red Hat Enterprise Linux Desktop (v. 5 client) - i386, x86_64

3. Description:

Samba is a suite of programs used by machines to share files, printers, and
other information.

A cross-site scripting (XSS) flaw was found in the password change page of
the Samba Web Administration Tool (SWAT). If a remote attacker could trick
a user, who was logged into the SWAT interface, into visiting a
specially-crafted URL, it would lead to arbitrary web script execution in
the context of the user's SWAT session. (CVE-2011-2694)

It was found that SWAT web pages did not protect against Cross-Site
Request Forgery (CSRF) attacks. If a remote attacker could trick a user,
who was logged into the SWAT interface, into visiting a specially-crafted
URL, the attacker could perform Samba configuration changes with the
privileges of the logged in user. (CVE-2011-2522)

It was found that the fix for CVE-2010-0547, provided by the Samba rebase
in RHBA-2011:0054, was incomplete. The mount.cifs tool did not properly
handle share or directory names containing a newline character, allowing a
local attacker to corrupt the mtab (mounted file systems table) file via a
specially-crafted CIFS (Common Internet File System) share mount request,
if mount.cifs had the setuid bit set. (CVE-2011-2724)

It was found that the mount.cifs tool did not handle certain errors
correctly when updating the mtab file. If mount.cifs had the setuid bit
set, a local attacker could corrupt the mtab file by setting a small file
size limit before running mount.cifs. (CVE-2011-1678)

Note: mount.cifs from the samba3x packages distributed by Red Hat does not
have the setuid bit set. We recommend that administrators do not manually
set the setuid bit for mount.cifs.

Red Hat would like to thank the Samba project for reporting CVE-2011-2694
and CVE-2011-2522, and Dan Rosenberg for reporting CVE-2011-1678. Upstream
acknowledges Nobuhiro Tsuji of NTT DATA Security Corporation as the
original reporter of CVE-2011-2694, and Yoshihiro Ishikawa of LAC Co., Ltd.
as the original reporter of CVE-2011-2522.

Users of Samba are advised to upgrade to these updated packages, which
contain backported patches to resolve these issues. After installing this
update, the smb service will be restarted automatically.

4. Solution:

Before applying this update, make sure all previously-released errata
relevant to your system have been applied.

This update is available via the Red Hat Network. Details on how to
use the Red Hat Network to apply this update are available at
<a  rel="nofollow" href="https://access.redhat.com/kb/docs/DOC-11259">https://access.redhat.com/kb/docs/DOC-11259</a>

5. Bugs fixed (<a  rel="nofollow" href="http://bugzilla.redhat.com/">http://bugzilla.redhat.com/</a>):

695925 - CVE-2011-1678 samba/cifs-utils: mount.cifs and umount.cifs fail to anticipate RLIMIT_FSIZE
721348 - CVE-2011-2522 samba (SWAT): Absent CSRF protection in various Samba web configuration formulars
722537 - CVE-2011-2694 samba (SWAT): XSS flaw in Change Password page
726691 - CVE-2011-2724 samba, cifs-utils: mount.cifs incorrect fix for CVE-2010-0547

6. Package List:

Red Hat Enterprise Linux Desktop (v. 5 client):

Source:
<a  rel="nofollow" href="ftp://ftp.redhat.com/pub/redhat/linux/enterprise/5Client/en/os/SRPMS/samba3x-3.5.4-0.83.el5_7.2.src.rpm">ftp://ftp.redhat.com/pub/redhat/linux/enterprise/5Client/en/os/SRPMS/samba3x-3.5.4-0.83.el5_7.2.src.rpm</a>

i386:
samba3x-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-client-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-common-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-doc-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-domainjoin-gui-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-swat-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-winbind-3.5.4-0.83.el5_7.2.i386.rpm

x86_64:
samba3x-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-client-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-common-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-doc-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-domainjoin-gui-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-swat-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-winbind-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-winbind-3.5.4-0.83.el5_7.2.x86_64.rpm

RHEL Desktop Workstation (v. 5 client):

Source:
<a  rel="nofollow" href="ftp://ftp.redhat.com/pub/redhat/linux/enterprise/5Client/en/os/SRPMS/samba3x-3.5.4-0.83.el5_7.2.src.rpm">ftp://ftp.redhat.com/pub/redhat/linux/enterprise/5Client/en/os/SRPMS/samba3x-3.5.4-0.83.el5_7.2.src.rpm</a>

i386:
samba3x-debuginfo-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-winbind-devel-3.5.4-0.83.el5_7.2.i386.rpm

x86_64:
samba3x-debuginfo-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-winbind-devel-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-winbind-devel-3.5.4-0.83.el5_7.2.x86_64.rpm

Red Hat Enterprise Linux (v. 5 server):

Source:
<a  rel="nofollow" href="ftp://ftp.redhat.com/pub/redhat/linux/enterprise/5Server/en/os/SRPMS/samba3x-3.5.4-0.83.el5_7.2.src.rpm">ftp://ftp.redhat.com/pub/redhat/linux/enterprise/5Server/en/os/SRPMS/samba3x-3.5.4-0.83.el5_7.2.src.rpm</a>

i386:
samba3x-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-client-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-common-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-doc-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-domainjoin-gui-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-swat-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-winbind-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-winbind-devel-3.5.4-0.83.el5_7.2.i386.rpm

ia64:
samba3x-3.5.4-0.83.el5_7.2.ia64.rpm
samba3x-client-3.5.4-0.83.el5_7.2.ia64.rpm
samba3x-common-3.5.4-0.83.el5_7.2.ia64.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.ia64.rpm
samba3x-doc-3.5.4-0.83.el5_7.2.ia64.rpm
samba3x-domainjoin-gui-3.5.4-0.83.el5_7.2.ia64.rpm
samba3x-swat-3.5.4-0.83.el5_7.2.ia64.rpm
samba3x-winbind-3.5.4-0.83.el5_7.2.ia64.rpm
samba3x-winbind-devel-3.5.4-0.83.el5_7.2.ia64.rpm

ppc:
samba3x-3.5.4-0.83.el5_7.2.ppc.rpm
samba3x-client-3.5.4-0.83.el5_7.2.ppc.rpm
samba3x-common-3.5.4-0.83.el5_7.2.ppc.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.ppc.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.ppc64.rpm
samba3x-doc-3.5.4-0.83.el5_7.2.ppc.rpm
samba3x-domainjoin-gui-3.5.4-0.83.el5_7.2.ppc.rpm
samba3x-swat-3.5.4-0.83.el5_7.2.ppc.rpm
samba3x-winbind-3.5.4-0.83.el5_7.2.ppc.rpm
samba3x-winbind-3.5.4-0.83.el5_7.2.ppc64.rpm
samba3x-winbind-devel-3.5.4-0.83.el5_7.2.ppc.rpm
samba3x-winbind-devel-3.5.4-0.83.el5_7.2.ppc64.rpm

s390x:
samba3x-3.5.4-0.83.el5_7.2.s390x.rpm
samba3x-client-3.5.4-0.83.el5_7.2.s390x.rpm
samba3x-common-3.5.4-0.83.el5_7.2.s390x.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.s390.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.s390x.rpm
samba3x-doc-3.5.4-0.83.el5_7.2.s390x.rpm
samba3x-domainjoin-gui-3.5.4-0.83.el5_7.2.s390x.rpm
samba3x-swat-3.5.4-0.83.el5_7.2.s390x.rpm
samba3x-winbind-3.5.4-0.83.el5_7.2.s390.rpm
samba3x-winbind-3.5.4-0.83.el5_7.2.s390x.rpm
samba3x-winbind-devel-3.5.4-0.83.el5_7.2.s390.rpm
samba3x-winbind-devel-3.5.4-0.83.el5_7.2.s390x.rpm

x86_64:
samba3x-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-client-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-common-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-debuginfo-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-doc-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-domainjoin-gui-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-swat-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-winbind-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-winbind-3.5.4-0.83.el5_7.2.x86_64.rpm
samba3x-winbind-devel-3.5.4-0.83.el5_7.2.i386.rpm
samba3x-winbind-devel-3.5.4-0.83.el5_7.2.x86_64.rpm

These packages are GPG signed by Red Hat for security.  Our key and 
details on how to verify the signature are available from
<a  rel="nofollow" href="https://access.redhat.com/security/team/key/#package">https://access.redhat.com/security/team/key/#package</a>

7. References:

<a  rel="nofollow" href="https://www.redhat.com/security/data/cve/CVE-2011-1678.html">https://www.redhat.com/security/data/cve/CVE-2011-1678.html</a>
<a  rel="nofollow" href="https://www.redhat.com/security/data/cve/CVE-2011-2522.html">https://www.redhat.com/security/data/cve/CVE-2011-2522.html</a>
<a  rel="nofollow" href="https://www.redhat.com/security/data/cve/CVE-2011-2694.html">https://www.redhat.com/security/data/cve/CVE-2011-2694.html</a>
<a  rel="nofollow" href="https://www.redhat.com/security/data/cve/CVE-2011-2724.html">https://www.redhat.com/security/data/cve/CVE-2011-2724.html</a>
<a  rel="nofollow" href="https://access.redhat.com/security/updates/classification/#moderate">https://access.redhat.com/security/updates/classification/#moderate</a>

8. Contact:

The Red Hat security contact is &lt;secalert redhat com&gt;.  More contact
details at <a  rel="nofollow" href="https://access.redhat.com/security/team/contact/">https://access.redhat.com/security/team/contact/</a>

Copyright 2011 Red Hat, Inc.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.4 (GNU/Linux)

iD8DBQFOW9D3XlSAg2UNWIIRAiBIAJ94bis53lBOuMQhqo71HAjqyqeDxgCfe1RE
zE9jl6cqN6/fOI58SZN2Q34=
=RDd4
-----END PGP SIGNATURE-----


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
[<a href="msg00021.html">Date Prev</a>][<a href="msg00023.html">Date Next</a>] &nbsp; [<a href="msg00021.html">Thread Prev</a>][<a href="msg00023.html">Thread Next</a>] &nbsp; 
[<A HREF="thread.html#00022">Thread Index</A>]
[<A HREF="date.html#00022">Date Index</A>]
[<A HREF="author.html#00022">Author Index</A>]

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
<!--#include virtual="/footer.html"-->
</body>
</html>
